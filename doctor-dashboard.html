<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞ ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶° - CuraFam</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; background: #f8fafc; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
        header { background: linear-gradient(135deg, #2E8B57, #20B2AA); color: white; padding: 1rem 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        header .container { display: flex; justify-content: space-between; align-items: center; }
        .logo h1 { font-size: 2rem; }
        .btn { display: inline-block; padding: 0.8rem 1.5rem; background: #2E8B57; color: white; text-decoration: none; border-radius: 8px; transition: all 0.3s; border: none; cursor: pointer; }
        .btn:hover { background: #236B43; transform: translateY(-2px); }
        .btn-secondary { background: #20B2AA; }
        .btn-danger { background: #dc2626; }
        .dashboard { padding: 2rem 0; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem; }
        .stat-card { background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; }
        .stat-number { font-size: 2rem; font-weight: bold; color: #2E8B57; }
        .qa-card { background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 1rem; }
        .question-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
        .question-type { padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.8rem; font-weight: 600; }
        .question-type.human { background: #dbeafe; color: #1e40af; }
        .question-type.animal { background: #fef3c7; color: #d97706; }
        .form-group { margin-bottom: 1rem; }
        .form-group textarea { width: 100%; padding: 0.8rem; border: 2px solid #e5e7eb; border-radius: 8px; min-height: 100px; }
        .no-questions { text-align: center; padding: 3rem; color: #666; }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <h1><i class="fas fa-heartbeat"></i> CuraFam</h1>
                <p>‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞ ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°</p>
            </div>
            <nav>
                <a href="index.html" class="btn btn-secondary">‡¶π‡ßã‡¶Æ</a>
                <a href="doctor-portal.html" class="btn">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®</a>
            </nav>
        </div>
    </header>

    <main class="dashboard">
        <div class="container">
            <div style="background: white; padding: 1rem; border-radius: 10px; margin-bottom: 2rem; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                <h3>‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞ ‡¶≤‡¶ó‡¶á‡¶®</h3>
                <div style="display: flex; gap: 1rem; align-items: center; margin-top: 1rem;">
                    <input type="text" id="doctorIdInput" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ID" style="flex: 1; padding: 0.8rem; border: 2px solid #e5e7eb; border-radius: 8px;">
                    <button class="btn" onclick="loginDoctor()">‡¶≤‡¶ó‡¶á‡¶®</button>
                    <button class="btn btn-danger" onclick="logoutDoctor()">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
                </div>
                <div id="loginStatus" style="margin-top: 1rem; font-weight: bold;"></div>
            </div>
            
            <div id="dashboardContent" style="display: none;">
                <h2 id="welcomeMessage">‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ, ‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞!</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalQuestions">0</div>
                    <p>‡¶Æ‡ßã‡¶ü ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®</p>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="answeredQuestions">0</div>
                    <p>‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®</p>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pendingQuestions">0</div>
                    <p>‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶Æ‡¶æ‡¶£ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®</p>
                </div>
                <div class="stat-card" onclick="showNotifications()" style="cursor: pointer; border: 2px solid #20B2AA;">
                    <div class="stat-number" id="newNotifications" style="color: #dc2626;">0</div>
                    <p>üîî ‡¶®‡¶§‡ßÅ‡¶® ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶®</p>
                </div>
            </div>

            <div id="notificationPanel" style="display: none; background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 2rem;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h3>üîî ‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶®</h3>
                    <button class="btn btn-secondary" onclick="hideNotifications()">‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                </div>
                <div id="notificationsList"></div>
            </div>

            <h3>‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶Æ‡¶æ‡¶£ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡¶∏‡¶Æ‡ßÇ‡¶π</h3>
            <div id="questionsContainer">
                <div class="no-questions">
                    <i class="fas fa-comments" style="font-size: 3rem; color: #20B2AA; margin-bottom: 1rem;"></i>
                    <h3>‡¶ï‡ßã‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶®‡ßá‡¶á</h3>
                    <p>‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶® ‡¶∞‡ßã‡¶ó‡ßÄ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ï‡¶∞‡ßá‡¶®‡¶ø‡•§</p>
                </div>
            </div>
            </div>
        </div>
    </main>

    <script>
        class LocalDatabase {
            getQuestions() {
                return JSON.parse(localStorage.getItem('curafam_questions') || '[]');
            }
            getDoctors() {
                return JSON.parse(localStorage.getItem('curafam_doctors') || '[]');
            }
            getNotifications() {
                return JSON.parse(localStorage.getItem('curafam_notifications') || '[]');
            }
            markNotificationRead(notificationId) {
                const notifications = this.getNotifications();
                const notification = notifications.find(n => n.id === notificationId);
                if (notification) {
                    notification.read = true;
                    localStorage.setItem('curafam_notifications', JSON.stringify(notifications));
                }
            }
            updateQuestion(questionId, answer, doctorId) {
                const doctors = this.getDoctors();
                const doctor = doctors.find(d => d.id === doctorId);
                if (!doctor) {
                    return { success: false, error: '‡¶Ö‡¶¨‡ßà‡¶ß ‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞ ID' };
                }
                
                const questions = this.getQuestions();
                const questionIndex = questions.findIndex(q => q.id === questionId);
                if (questionIndex !== -1) {
                    questions[questionIndex].answer = answer;
                    questions[questionIndex].answeredAt = new Date().toISOString();
                    questions[questionIndex].answeredBy = doctor.name;
                    questions[questionIndex].doctorId = doctorId;
                    localStorage.setItem('curafam_questions', JSON.stringify(questions));
                    return { success: true };
                }
                return { success: false, error: '‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø' };
            }
        }

        const localDB = new LocalDatabase();

        function loadDashboard() {
            const questions = localDB.getQuestions();
            const answered = questions.filter(q => q.answer);
            const pending = questions.filter(q => !q.answer);
            const notifications = localDB.getNotifications();
            const unreadNotifications = notifications.filter(n => !n.read);

            document.getElementById('totalQuestions').textContent = questions.length;
            document.getElementById('answeredQuestions').textContent = answered.length;
            document.getElementById('pendingQuestions').textContent = pending.length;
            document.getElementById('newNotifications').textContent = unreadNotifications.length;

            const container = document.getElementById('questionsContainer');
            if (pending.length === 0) {
                container.innerHTML = `
                    <div class="no-questions">
                        <i class="fas fa-comments" style="font-size: 3rem; color: #20B2AA; margin-bottom: 1rem;"></i>
                        <h3>‡¶ï‡ßã‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶®‡ßá‡¶á</h3>
                        <p>‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶® ‡¶∞‡ßã‡¶ó‡ßÄ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ï‡¶∞‡ßá‡¶®‡¶ø‡•§</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = pending.map(q => `
                <div class="qa-card">
                    <div class="question-header">
                        <h3>${q.title}</h3>
                        <span class="question-type ${q.type}">${q.type === 'human' ? '‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑' : '‡¶™‡¶∂‡ßÅ'}</span>
                    </div>
                    <p><strong>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®:</strong> ${q.description}</p>
                    <p><strong>‡¶¨‡¶Ø‡¶º‡¶∏:</strong> ${q.age || '‡¶â‡¶≤‡ßç‡¶≤‡ßá‡¶ñ ‡¶®‡ßá‡¶á'}</p>
                    <p><strong>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</strong> ${new Date(q.createdAt).toLocaleDateString('bn-BD')}</p>
                    
                    <div class="form-group">
                        <label>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞:</label>
                        <textarea id="answer_${q.id}" placeholder="‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..."></textarea>
                    </div>
                    <button class="btn" onclick="submitAnswer('${q.id}')">‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®</button>
                </div>
            `).join('');
        }

        function loginDoctor() {
            const doctorId = document.getElementById('doctorIdInput').value.trim();
            if (!doctorId) {
                alert('‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ID ‡¶¶‡¶ø‡¶®');
                return;
            }
            
            const doctors = localDB.getDoctors();
            const doctor = doctors.find(d => d.id === doctorId);
            if (doctor) {
                localStorage.setItem('curafam_logged_doctor', doctorId);
                document.getElementById('loginStatus').innerHTML = `<span style="color: green;">‚úì ‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡¶´‡¶≤: ${doctor.name}</span>`;
                document.getElementById('welcomeMessage').textContent = `‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ, ‡¶°‡¶æ. ${doctor.name}!`;
                document.getElementById('dashboardContent').style.display = 'block';
                loadDashboard();
            } else {
                alert('‡¶Ö‡¶¨‡ßà‡¶ß ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ID');
            }
        }
        
        function logoutDoctor() {
            localStorage.removeItem('curafam_logged_doctor');
            document.getElementById('loginStatus').innerHTML = '<span style="color: red;">‚úó ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</span>';
            document.getElementById('dashboardContent').style.display = 'none';
            document.getElementById('doctorIdInput').value = '';
        }

        function submitAnswer(questionId) {
            const loggedDoctorId = localStorage.getItem('curafam_logged_doctor');
            if (!loggedDoctorId) {
                alert('‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®');
                return;
            }
            
            const answerText = document.getElementById(`answer_${questionId}`).value.trim();
            if (!answerText) {
                alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§');
                return;
            }

            const result = localDB.updateQuestion(questionId, answerText, loggedDoctorId);
            if (result.success) {
                alert('‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
                loadDashboard();
            } else {
                alert('‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ' + result.error);
            }
        }

        function showNotifications() {
            const notifications = localDB.getNotifications();
            const panel = document.getElementById('notificationPanel');
            const list = document.getElementById('notificationsList');
            
            if (notifications.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #666;">‡¶ï‡ßã‡¶® ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶®‡ßá‡¶á</p>';
            } else {
                list.innerHTML = notifications.map(n => `
                    <div style="padding: 1rem; border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 0.5rem; ${n.read ? 'opacity: 0.6;' : 'background: #f0f9ff;'}">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4 style="color: #2E8B57; margin: 0;">${n.title}</h4>
                                <p style="margin: 0.5rem 0; color: #666;">‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® (${n.type === 'human' ? '‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑' : '‡¶™‡¶∂‡ßÅ'})</p>
                                <small style="color: #888;">${new Date(n.createdAt).toLocaleString('bn-BD')}</small>
                            </div>
                            <button class="btn" onclick="markAsRead('${n.id}')" ${n.read ? 'disabled' : ''}>
                                ${n.read ? '‡¶™‡ßú‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá' : '‡¶™‡ßú‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®'}
                            </button>
                        </div>
                    </div>
                `).join('');
            }
            
            panel.style.display = 'block';
        }
        
        function hideNotifications() {
            document.getElementById('notificationPanel').style.display = 'none';
        }
        
        function markAsRead(notificationId) {
            localDB.markNotificationRead(notificationId);
            loadDashboard();
            showNotifications();
        }

        document.addEventListener('DOMContentLoaded', function() {
            const loggedDoctorId = localStorage.getItem('curafam_logged_doctor');
            if (loggedDoctorId) {
                const doctors = localDB.getDoctors();
                const doctor = doctors.find(d => d.id === loggedDoctorId);
                if (doctor) {
                    document.getElementById('doctorIdInput').value = loggedDoctorId;
                    document.getElementById('loginStatus').innerHTML = `<span style="color: green;">‚úì ‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡¶´‡¶≤: ${doctor.name}</span>`;
                    document.getElementById('welcomeMessage').textContent = `‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ, ‡¶°‡¶æ. ${doctor.name}!`;
                    document.getElementById('dashboardContent').style.display = 'block';
                    loadDashboard();
                }
            }
        });
    </script>
</body>
</html>